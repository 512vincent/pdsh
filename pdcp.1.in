\." $Id$
.\"
.TH "@PROJECT@" "1" "@host_os@" "Version @VERSION@-@RELEASE@"
.SH NAME
pdcp \- copy files to groups of hosts in parallel
.SH SYNOPSIS
.B pdcp
.I "[-options] src [src2...] dest"
.br
.SH DESCRIPTION
.B pdcp
is a variant of the rcp(1) command.  Unlike rcp(1) which copies files
to a single remote host, pdcp(1) can copy files to multiple remote
hosts in parallel.  A number of options and features for pdcp are
dependent on how pdcp has been built and installed.  See MODULES below
for further explanation.  Pdcp options are described in TARGET NODE
LIST OPTIONS and OTHER OPTIONS below.
.LP
When pdcp receives SIGINT (ctrl-C), it lists the status of current threads.
A second SIGINT within one second terminates the program.
.SH MODULES
A number of options and features in pdcp depend n the modules
that have been built or installed with pdcp.  The following is a list of
modules that can be installed with pdsh and the command line options
available when that module is installed.  A list of all module types
installed can be found using the -L option.
.LP
Note that the same command line options are offered by several
different modules.  If two installed modules offer the same command line
option, pdsh will default to only one of modules.  A list of all
available command line options can be listed with the -h
option.
.LP
.IP "\fBRCMD MODULES\fR" 0
.LP
.B Pdcp 
originally executed remote copies through rcmd(3) (the library
routine used by rsh(1)).  Depending on the modules installed, remote
copies can now be executed through several different services.  The
user can select the service using the -R option.  Atleast one of the
following must be installed on the system in order for pdcp to
function.  If multiple rcmd modules are installed on the same system,
the default service selected by pdcp is based on the order listed below.
A list of all available rcmd modules is listed with the -h option.
.LP
.B bsd
.LP
The bsd module allows users to remote copy through rsh(1).  
.LP
.B mrsh
.LP
The mrsh module allows users to remote copy through mrsh(1).
.LP
.B ssh
.LP
The ssh module allows users to remote copy through ssh(1).
.LP
The krb4
.LP
The k4b4 module allows users to execute remote commands after
authenticating with kerberos.
.LP
.IP "\fBFEATURE MODULES\fR" 0
.LP
The following modules may be available to pdcp.  They give the
user a number of other possible options when running pdcp.
.LP
.B genders
.LP
The genders module allows pdcp to access the genders database through
the genders(3) library.  The -g, -a, and -i options are available when
this module is installed.
.LP
.B machines
.LP
The machines modules loads a list of all cluster nodes from a file
location specified during compile time.  The -a option is available 
when this module is installed.
.LP
.B nodeattr
.LP
The nodeattr module allows pdcp to access the genders database through
the nodeattr(1) command.  This module is primarily needed for older
systems that do not yet have the gender(3) library installed.  The -g,
-a, and -i options are available when this module is installed.
.LP
.B nodeupdown
.LP
The nodeupdown module allows pdcp to interact with the nodeupdown(3)
library.  The -v option is available when this module is
installed.
.LP
.B rms
.LP
The rms module allows pdsh to target nodes based on an RMS resource.
See TARGET NODE LIST OPTIONS below for additional details.
.LP
.B SDR
.LP
The SDR module supports SDR on IBM SPs.  The -a, -i, -v, and -G
options are available when this module is installed.
.LP
.SH TARGET NODE LIST OPTIONS
.I "-w host,host,..."
Target the specified hosts.  Conflicts with -a and -g options.  No
spaces are allowed in the comma-separated list.  A list consisting of
a single "-" character causes the target hosts to be read from stdin,
one per line.  The host list may contain hostname ranges of the form
``host[1-5]''. For more information about hostname ranges, see the
HOST RANGES section below.
.LP
.I "-x host,host,..."
Exclude the specified hosts.  May be specified in conjunction with other
target node list options such as -a. Hostname ranges may also be specified
to the -x option (see HOST RANGES section below)
.LP
.I "-a"
Target "all" nodes in the cluster.  Conflicts with -w and -g options.
Available only if the genders, nodeattr, SDR, or machines module is
installed.
.LP
.I "-v"
In combination with -a, eliminate nodes that are down.  Available only
if the SDR or nodeupdown module is installed.
.LP
.I "-G"
In combination with -a, include all partitions. Available only 
if the SDR module is installed.
.LP
.I "-g attribute"
Target nodes that have the specified genders attribute.  Conflicts
with -a and -w options.  Available only if the genders or nodeattr
module is installed.
.LP
.I "-i"
In conjunction with -a or -g, request canonical hostnames.  The
default is to use reliable hostnames.  Available only if the
genders or nodeattr module is installed.
.LP
If none of the above options are specified, the WCOLL environment variable
must point to a file that contains a list of nodes, one per line.  
.SH OTHER OPTIONS
.I "-h" 
Output usage menu and quit.
.LP
.I "-L"
List info on all loaded modules and exit.
.LP
.I "-R name"
Set rcmd module to name.
.LP
.I "-r"
Copy recursively.
.LP
.I "-p"
Preserve modification time and modes.
.LP
.I "-q"
List option values and the target host list and exit without action.
.LP
.I "-f number"
Set the maximum number of simultaneous remote copies.  The default is 
@FANOUT@.
.LP
.I "-l user"
This option may be used to copy files as another user, subject to
authorization.  For BSD rcmd, this means the invoking user and system must
be listed in the user\'s .rhosts file (even for root).
.LP
.I "-t seconds"
Set the connect timeout.  Default is @CONNECT_TIMEOUT@ seconds.  
.LP
.I "-d"
Include more complete thread status when SIGINT is received, and display
connect and command time statistics on stderr when done.
.SH "HOST RANGES"
As noted in sections above, 
.B pdcp 
accepts ranges of hostnames in
the general form: prefix[n-m,l-k,...], where n < m and l < k, etc.,
as an alternative to explicit lists of hosts.  This form should not
be confused with regular expression character classes (also denoted
by ``[]''). For example, foo[19] does not represent foo1 or foo9, but
rather represents a degenerate range: foo19. 

This range syntax is meant
only as a convenience on clusters with a prefixNN naming convention and
specification of ranges should not be considered necessary -- the list
foo1,foo9 could be specified as such, or by the range foo[1,9].

Some examples of range usage follow:

Copy /etc/hosts to foo01,foo02,...,foo05
    pdcp -w foo[01-05] /etc/hosts /etc

Copy /etc/hosts to foo7,foo9,foo10
    pdcp -w foo[7,9-10] /etc/hosts /etc

Copy /etc/hosts to foo0,foo4,foo5
    pdcp -w foo[0-5] -x foo[1-3] /etc/hosts /etc

As a reminder to the reader, some shells will interpret brackets ('['
and ']') for pattern matching.  Depending on your shell, it may be
necessary to enclose ranged lists within quotes.  For example, in
tcsh, the first example above should be executed as:

    pdcp -w "foo[01-05]" /etc/hosts /etc

.SH "ORIGIN"
Pdsh/pdcp was originally a rewrite of IBM dsh(1) by Jim Garlick
.br
<garlick@llnl.gov>
on LLNL's ASCI Blue-Pacific IBM SP system.  
It is now also used on Linux clusters at LLNL.

.SH "LIMITATIONS"
When using 
.B ssh 
for remote execution, stderr of ssh to be folded in with that of the
remote command.  When invoked by pdcp, it is not possible for ssh to
prompt for confirmation if a host key changes, prompt for passwords if
RSA keys are not configured properly, etc..  Finally, the connect
timeout is not adjustable when ssh is used.

Host range parsing assumes numerical part of hostname is at the end,
e.g.  specifying foo[0-5]bar will not work.

.SH "FILES"
.if @HAVE_NODEATTR@ \{
@NODEATTR@
.br
\}
.if @HAVE_SDR@ \{
@SDRGETOBJECTS@
.br
\}
.if @HAVE_MACHINES@ \{
@MACHINES@
.br
\}
.br
@RCP@
.br
.SH "SEE ALSO"
rcp(1), pdsh(1)
