\." $Id$
.\"
.TH "@PROJECT@" "1" "@host_os@" "Version @VERSION@-@RELEASE@"

.SH NAME
pdsh \- issue commands to groups of hosts in parallel

.SH SYNOPSIS
.B pdsh
.I "[-options] command"

.SH DESCRIPTION

.B pdsh
is a variant of the rsh(1) command.  Unlike rsh(1) which runs commands on
a single remote host, pdsh(1) can run multiple remote commands in parallel.
Options are described in TARGET NODE LIST OPTIONS and OTHER OPTIONS below.
.LP
When pdsh receives SIGINT (ctrl-C), it lists the status of current threads.
A second SIGINT within one second terminates the program.
.LP
The DSHPATH environment variable, if set, will be the PATH for the remote shell.
.LP
If a command is not specified on the command line, 
.B pdsh
runs interactively, prompting for commands and executing them when
terminated with a carriage return.  In interactive mode, target nodes that 
time out on the first command are not contacted for subsequent commands,
and commands prefaced with an exclamation point will be executed on the local 
system.

.SH TARGET NODE LIST OPTIONS

.I "-w host,host,..."
Target the specified hosts.  No spaces are allowed in the comma-separated
list.  A list consisting of a single "-" character causes the target 
hosts to be read from stdin, one per line.  The host list may contain 
hostname ranges of the form ``host1@RANGE_OP@5'' or ``host[1@RANGE_OP@5]''.
The PDSH_RANGE_OPERATOR environment variable will override the default 
range operator character of '@RANGE_OP@', or disable hostname range 
expansion if set to the empty string.
.LP
.I "-a"
Target "all" nodes in the cluster.
.if @HAVE_SDR@ \{
.I "-v"
In combination with -a, eliminate nodes that the SDR thinks are down.
.LP
.I "-G"
In combination with -a, include all partitions. 
\}
.if @HAVE_GENDERS@ \{
.I "-g attribute"
Target nodes that have the specified genders attribute.	
\}
.if @HAVE_RMS@ \{
.I "-N nodecount"
Request that nodes be allocated from RMS.
.LP
.I "-P partition"
Select non-default RMS partition.
\}
.LP
.I "-i"
In conjunction with -a or -g, request alternate hostnames.
.LP
If none of the above options are specified, the WCOLL environment variable
must point to a file that contains a list of nodes, one per line.  

.SH OTHER OPTIONS
.I "-q"
List option values and the target nodes and exit without action.
.LP
.I "-f number"
Set the maximum number of simultaneous remote commands.  The default is 
@FANOUT@.
.LP
.I "-s"
Combine remote command stderr with stdout.  Combining these saves one socket
per connection, but breaks remote cleanup when 
.B pdsh 
is interrupted with a ctrl-C.
NOTE: this option has the reverse meaning on AIX where remote cleanup
works without the extra socket.
.LP
.I "-l user"
This option may be used to run remote comands as another user, subject to
authorization.  For BSD rcmd, this means the invoking user and system must
be listed in the user\'s .rhosts file (even for root).
.LP
.I "-t seconds"
Set the connect timeout.  Default is @CONNECT_TIMEOUT@ seconds.  
(This is concurrent with the normal socket-level timeout).
.LP
.I "-u seconds"
Put a limit on the amount of time a remote command is allowed to execute.
Default is no limit.
.LP
.I "-c"
In interactive mode, do not remove failed hosts from the target node list.
.if @HAVE_ELAN@ \{
.I "-E"
Run command using qshell.  Qshell propagates the
.B pdsh 
environment and current working directory to remote processes.
To enable running of MPI jobs on the Quadrics Elan3 interconnect,
Elan capabilities are propagated and the following environment variables 
are set: RMS_RANK, RMS_NODEID, RMS_PROCID, RMS_NNODES, and RMS_NPROCS.
.LP
.I "-n number"
In combination with -E, set the number of total processes, which should
be a multiple of the number of hosts in the target host list.
.LP
.I "-m block | cyclic"
In combination wiht -E, set block versus cyclic allocation of processes 
to nodes.  Default is block.
\}
.LP
.I "-d"
Include more complete thread status when SIGINT is received, and display
connect and command time statistics on stderr when done.
.LP
.I "-S"
Return largest of the remote command return values.

.SH "ORIGIN"
Originally a rewrite of IBM dsh(1) by Jim Garlick <garlick@llnl.gov>
on LLNL's ASCI Blue-Pacific IBM SP system.  
It is now also used on Linux clusters at LLNL.

.SH "LIMITATIONS"
.LP
.if @HAVE_SSH@ \{
This copy of pdsh has been configured to use
.B ssh
which causes the stderr of ssh to be folded in with that of the remote 
command.  When invoked by pdsh, it is not possible for ssh to prompt for 
confirmation if a host key changes, prompt for passwords if RSA keys are not 
configured properly, etc..  Finally, the connect timeout is not adjustable 
when ssh is used.
\}
.if @HAVE_ELAN@ \{
Qshell assumes Elan3 single rail.
.LP
Output from multiple processes per node may be interspersed when using Qshell.
\}

.SH "FILES"
.if @HAVE_SSH@ @SSH@
.br
.if @HAVE_RMS@ @RMSQUERY@
.br
.if @HAVE_GENDERS@ @NODEATTR@
.br
.if @HAVE_SDR@ @SDRGETOBJECTS@
.br
.if @HAVE_MACHINES@ @MACHINES@

.SH "SEE ALSO"
rsh(1), ssh(1), dshbak(1), pdcp(1)
